<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Seven Royal Stars School Management System</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:400,700&display=swap">
  <style>
    body { font-family: 'Inter', Arial, sans-serif; background: #f4f7fa; margin: 0; }
    .container { max-width: 1200px; margin: 32px auto; background: #fff; border-radius: 12px; box-shadow: 0 4px 32px rgba(0,0,0,.09); padding: 30px 30px 60px 30px; }
    nav { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #e0e6ed; margin-bottom: 20px; }
    .nav-title { font-size: 2em; font-weight: 700; color: #254178; }
    .nav-actions { display: flex; gap: 14px; }
    .btn { background: #254178; color: #fff; border: none; border-radius: 5px; padding: 6px 18px; font-size: 1em; cursor: pointer; margin: 2px; }
    .btn-secondary { background: #e0e6ed; color: #254178; }
    .btn-danger { background: #e23a3a; }
    .btn-success { background: #25a978; }
    .section-nav { margin: 15px 0; display: flex; gap: 11px; flex-wrap: wrap;}
    .dashboard-grid { display: flex; gap: 24px; margin: 16px 0 24px 0; flex-wrap: wrap;}
    .stat-box { background: linear-gradient(90deg, #254178 60%, #25a978 100%); color: #fff; border-radius: 10px; padding: 18px 26px; flex: 1; box-shadow: 0 2px 12px rgba(0,0,0,.07); font-size: 1.08em; text-align: center; min-width: 180px;}
    .stat-label { font-size: .97em; color: #e0e6ed; margin-top: 7px; }
    .hidden { display: none !important; }
    .form-group { margin-bottom: 11px; }
    .form-group label { display: block; margin-bottom: 3px; font-weight: 600; }
    .form-group input, .form-group select { width: 100%; padding: 7px 10px; border: 1px solid #cbd5e1; border-radius: 5px; }
    .data-table { width: 100%; border-collapse: collapse; margin-top: 12px; background: #fafcff; }
    .data-table th, .data-table td { padding: 10px 10px; border: 1px solid #e0e6ed; text-align: left; }
    .data-table th { background: #f4f7fa; }
    .avatar { background: #25a978; color: #fff; font-weight: 700; width: 34px; height: 34px; display: flex; align-items: center; justify-content: center; border-radius: 50%; }
    .alert { padding: 10px 16px; margin: 8px 0; border-radius: 5px; font-weight: 600; }
    .alert-error { background: #ffe5e5; color: #b90000; }
    .alert-success { background: #e9fbe5; color: #0a5d2a; }
    .modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100vw; height: 100vh; overflow: auto; background: rgba(0,0,0,0.14); }
    .modal-content { background: #fff; margin: 50px auto; border-radius: 10px; padding: 30px 26px; max-width: 480px; min-width: 320px; position: relative; box-shadow: 0 2px 24px rgba(0,0,0,.08); }
    .close { color: #aaa; float: right; font-size: 2em; font-weight: 700; position: absolute; right: 15px; top: 8px; cursor: pointer; }
    .close:hover { color: #333; }
    #notificationContainer { position: fixed; top: 30px; right: 30px; z-index: 9999; max-width: 350px; }
    .notification { background: #fff; border-left: 6px solid #254178; border-radius: 6px; box-shadow: 0 2px 12px rgba(0,0,0,.13); padding: 15px 20px 15px 15px; margin-bottom: 11px; font-size: 1rem; color: #333; display: flex; align-items: center; animation: fadeInRight 0.35s; }
    .notification.success { border-left-color: #25a978; }
    .notification.error { border-left-color: #e23a3a; }
    .notification.info { border-left-color: #254178; }
    .notification .noti-close { margin-left: auto; font-size: 1.1em; cursor: pointer; color: #aaa; }
    .notification .noti-close:hover { color: #333; }
    @keyframes fadeInRight { from { opacity: 0; transform: translateX(70px);} to { opacity: 1; transform: translateX(0);} }
    @media (max-width: 900px) { .dashboard-grid { flex-direction: column; } }
    @media (max-width: 600px) { .container { padding: 5px; } }
    .switch-link { color: #25a978; cursor:pointer; text-decoration:underline; font-size:0.97em; }
    .switch-link:hover { text-decoration:underline; color:#254178; }
  </style>
</head>
<body>
<div class="container">
  <nav>
    <span class="nav-title">Seven Royal Stars School</span>
    <span class="nav-actions">
      <span id="userDisplay" class="avatar hidden"></span>
      <button class="btn btn-secondary" onclick="showModal('aboutModal')">About</button>
      <button class="btn btn-secondary" onclick="logout()" id="logoutBtn" style="display:none;">Logout</button>
    </span>
  </nav>
  <!-- Login/Register Section -->
  <div id="loginSection">
    <h2 id="loginTitle">Login</h2>
    <div id="loginAlert"></div>
    <form onsubmit="if(registering)return false;login();return false;">
      <div id="regEmailGroup" class="form-group" style="display:none;">
        <label>Email:</label>
        <input type="email" id="regEmail" autocomplete="email">
      </div>
      <div class="form-group">
        <label>Username:</label>
        <input type="text" id="username" required autocomplete="username">
      </div>
      <div class="form-group">
        <label>Password:</label>
        <input type="password" id="password" required autocomplete="current-password">
      </div>
      <div id="regConfirmGroup" class="form-group" style="display:none;">
        <label>Confirm Password:</label>
        <input type="password" id="regConfirm" autocomplete="new-password">
      </div>
      <div class="form-group">
        <label>Role:</label>
        <select id="userRole" required>
          <option value="admin">Administrator</option>
          <option value="teacher">Teacher</option>
        </select>
      </div>
      <button class="btn" id="loginBtn" type="submit">Login</button>
      <button class="btn btn-success" id="regBtn" type="button" style="display:none;">Register</button>
    </form>
    <div style="margin-top:14px;color:#888;">
      <span id="toggleReg" class="switch-link" onclick="toggleRegister()">New user? Register here</span>
      <span id="toggleLogin" class="switch-link" onclick="toggleLogin()" style="display:none;">Back to Login</span>
      <div style="margin-top:6px;">
        <b>Demo:</b> admin/admin123 or teacher/teacher123
      </div>
    </div>
  </div>
  <!-- Dashboard (unchanged) -->
  <div id="dashboard" class="hidden">
    <div class="dashboard-grid">
      <div class="stat-box"><span id="statStudents">0</span><div class="stat-label">Students</div></div>
      <div class="stat-box"><span id="statTeachers">0</span><div class="stat-label">Teachers</div></div>
      <div class="stat-box"><span id="statClasses">0</span><div class="stat-label">Classes</div></div>
      <div class="stat-box"><span id="statFeesPending">GHS 0.00</span><div class="stat-label">Fees Pending</div></div>
    </div>
    <div class="section-nav">
      <button class="btn" onclick="showSection('students')">Students</button>
      <button class="btn" onclick="showSection('teachers')">Teachers</button>
      <button class="btn" onclick="showSection('classes')">Classes</button>
      <button class="btn" onclick="showSection('attendance')">Attendance</button>
      <button class="btn" onclick="showSection('grades')">Grades</button>
      <button class="btn" onclick="showSection('fees')">Fees</button>
      <button class="btn" onclick="showSection('settings')">Settings</button>
      <button class="btn btn-secondary" onclick="showModal('importModal')">Import</button>
      <button class="btn btn-secondary" onclick="exportData()">Export</button>
    </div>
    <div id="mainSectionContent">
      <!-- ... (unchanged, see previous HTML for all sections and modals) ... -->
      <!-- ... (studentsSection, teachersSection, classesSection, etc.) ... -->
    </div>
  </div>
  <!-- ... (all modals, notification container as in previous answer) ... -->
  <div id="notificationContainer"></div>
</div>
<script>
/* --- Core data, storage, and registration logic --- */
// (Paste the full JS from the "full HTML" solution above here, then append the following block!)
/* --- Registration & login logic --- */
let registering = false;
function toggleRegister() {
  registering = true;
  document.getElementById('loginTitle').textContent = "Register";
  document.getElementById('loginBtn').style.display = "none";
  document.getElementById('regBtn').style.display = "";
  document.getElementById('regEmailGroup').style.display = "";
  document.getElementById('regConfirmGroup').style.display = "";
  document.getElementById('toggleReg').style.display = "none";
  document.getElementById('toggleLogin').style.display = "";
}
function toggleLogin() {
  registering = false;
  document.getElementById('loginTitle').textContent = "Login";
  document.getElementById('loginBtn').style.display = "";
  document.getElementById('regBtn').style.display = "none";
  document.getElementById('regEmailGroup').style.display = "none";
  document.getElementById('regConfirmGroup').style.display = "none";
  document.getElementById('toggleReg').style.display = "";
  document.getElementById('toggleLogin').style.display = "none";
  document.getElementById('loginAlert').innerHTML = '';
}
document.getElementById('regBtn').onclick = function() {
  const username = document.getElementById('username').value.trim();
  const password = document.getElementById('password').value;
  const confirm = document.getElementById('regConfirm').value;
  const email = document.getElementById('regEmail').value.trim();
  const role = document.getElementById('userRole').value;
  const alert = document.getElementById('loginAlert');
  if (!username || !password || !confirm || !email) {
    alert.innerHTML = '<div class="alert alert-error">All fields are required.</div>'; return;
  }
  if (password !== confirm) {
    alert.innerHTML = '<div class="alert alert-error">Passwords do not match.</div>'; return;
  }
  if (users.find(u=>u.username===username)) {
    alert.innerHTML = '<div class="alert alert-error">Username already exists.</div>'; return;
  }
  users.push({username, password, role, name:username, email, status:'active'});
  saveUsers();
  alert.innerHTML = '<div class="alert alert-success">Registration successful! You can now login.</div>';
  toggleLogin();
};
function saveUsers() {
  localStorage.setItem('school_users', JSON.stringify(users));
}
function loadUsers() {
  const d = localStorage.getItem('school_users');
  if (d) users = JSON.parse(d);
}
loadUsers();
</script>
</body>
</html>
